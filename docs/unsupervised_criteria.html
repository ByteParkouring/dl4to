---

title: Unsupervised criteria


keywords: fastai
sidebar: home_sidebar



nb_path: "notebooks/criteria/2_unsupervised_criteria.ipynb"
---
<!--

#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: notebooks/criteria/2_unsupervised_criteria.ipynb
# command to build the docs after a change: nbdev_build_docs

-->

<div class="container" id="notebook-container">
        
    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="UnsupervisedCriterion" class="doc_header"><code>class</code> <code>UnsupervisedCriterion</code><a href="dl4to/criteria.py#L674" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>UnsupervisedCriterion</code>(<strong><code>name</code></strong>:<code>str</code>, <strong><code>differentiable</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>lower_is_better</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>compute_only_on_design_space</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <a href="/dl4tocriteria.html#Criterion"><code>Criterion</code></a></p>
</blockquote>
<p>A parent class that inherits all unsupervised criteria for both classical and learned methods.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>name</code></strong></td>
<td><code>str</code></td>
<td></td>
<td>The name of this criterion which will be monitored in logging.</td>
</tr>
<tr>
<td><strong><code>differentiable</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether the criterion is differentiable or not. Only differentiable criteria can be used as loss/objective functions.</td>
</tr>
<tr>
<td><strong><code>lower_is_better</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether lower values of the criterion correspond to better scores.</td>
</tr>
<tr>
<td><strong><code>compute_only_on_design_space</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether the criterion should be evaluated on voxels that have a design space information of -1, i.e., the voxels can be freely optimized. This parameter does not effect all criteria.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h4 id="UnsupervisedCriterion.__call__" class="doc_header"><code>UnsupervisedCriterion.__call__</code><a href="dl4to/criteria.py#L699" class="source_link" style="float:right">[source]</a></h4><blockquote><p><code>UnsupervisedCriterion.__call__</code>(<strong><code>solutions</code></strong>:<code>list</code>, <strong><code>gt_solutions</code></strong>:<code>list</code>=<em><code>None</code></em>, <strong><code>binary</code></strong>:<code>bool</code>=<em><code>False</code></em>)</p>
</blockquote>
<p>Calculates the output of the criterion for all solutions.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>solutions</code></strong></td>
<td><code>list</code></td>
<td></td>
<td>The solutions that should be evaluated with the criterion.</td>
</tr>
<tr>
<td><strong><code>gt_solutions</code></strong></td>
<td><code>list</code></td>
<td><code>None</code></td>
<td>Ground truth solutions that are compared element-wise with the <code>solutions</code>. Since the criterion is unsupervised this does not have an effect.</td>
</tr>
<tr>
<td><strong><code>binary</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Whether the criterion should be evaluated on binarized densities. Does not have an effect on some criteria.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Compliance" class="doc_header"><code>class</code> <code>Compliance</code><a href="dl4to/criteria.py#L710" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Compliance</code>(<strong><code>α</code></strong>:<code>float</code>=<em><code>1e-09</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>The compliance criterion which is used to determine the structural integrity of mechanical structures.
The criterionis computes as $F^T u$, where $F$ are the external forces and $u$ are the displacements, which are derived from the PDE for linear elasticity.
Lower values are desired and higher values indicate worse scores.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>α</code></strong></td>
<td><code>float</code></td>
<td><code>1e-09</code></td>
<td>The weight that is used to rescale the forces F.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Volume" class="doc_header"><code>class</code> <code>Volume</code><a href="dl4to/criteria.py#L743" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Volume</code>(<strong><code>compute_only_on_design_space</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>Calculates the sum over all density values for each solution.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>compute_only_on_design_space</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Whether the criterion should be evaluated on voxels that have a design space information of -1, i.e., the voxels can be freely optimized. This parameter does not effect all criteria.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VolumeFraction" class="doc_header"><code>class</code> <code>VolumeFraction</code><a href="dl4to/criteria.py#L771" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VolumeFraction</code>(<strong><code>compute_only_on_design_space</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>Calculates the average density values for each solution. Therefore this criterion always returns values between 0 and 1.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>compute_only_on_design_space</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Whether the criterion should be evaluated on voxels that have a design space information of -1, i.e., the voxels can be freely optimized. This parameter does not effect all criteria.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="VolumeConstraint" class="doc_header"><code>class</code> <code>VolumeConstraint</code><a href="dl4to/criteria.py#L799" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>VolumeConstraint</code>(<strong><code>max_volume_fraction</code></strong>:<code>float</code>=<em><code>0.2</code></em>, <strong><code>threshold_fct</code></strong>:<code>str</code>=<em><code>'softplus'</code></em>, <strong><code>compute_only_on_design_space</code></strong>:<code>bool</code>=<em><code>False</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>This criterion checks if the volume fraction is below a pre-defined maximum volume fraction and punishes higher volumes.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>max_volume_fraction</code></strong></td>
<td><code>float</code></td>
<td><code>0.2</code></td>
<td>The maximum volume fraction threshold given as a float between 0 and 1.</td>
</tr>
<tr>
<td><strong><code>threshold_fct</code></strong></td>
<td><code>str</code></td>
<td><code>softplus</code></td>
<td>The function that determines how volume values above <code>max_volume_fraction</code> are punished. Can be either "relu" or "softplus", which is a smoothed version of ReLU.</td>
</tr>
<tr>
<td><strong><code>compute_only_on_design_space</code></strong></td>
<td><code>bool</code></td>
<td><code>False</code></td>
<td>Whether the criterion should be evaluated on voxels that have a design space information of -1, i.e., the voxels can be freely optimized. This parameter does not effect all criteria.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="ForcesUnderpinned" class="doc_header"><code>class</code> <code>ForcesUnderpinned</code><a href="dl4to/criteria.py#L839" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>ForcesUnderpinned</code>() :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>This criterion uses an infection algorithm to check if all voxels that have external forces applied to them are connected to the rest of the structure.
Returns 1 if the structure is connected, else it returns 0.</p>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="MaxStress" class="doc_header"><code>class</code> <code>MaxStress</code><a href="dl4to/criteria.py#L895" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>MaxStress</code>(<strong><code>compute_only_for_not_underpinned</code></strong>:<code>bool</code>=<em><code>True</code></em>, <strong><code>normalize</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>This criterion solves the PDE for linear elasticity and returns the maximum absolute von Mises stress value for each passed solution. If <code>normalize=True</code> then the value is normalized with the yield stress of the problem.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>compute_only_for_not_underpinned</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether not connected voxels should be included in the calculation. If True, then the maximum stress is only computed for voxels that are connected to the structure.</td>
</tr>
<tr>
<td><strong><code>normalize</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether the maximal absolute von Mises stress should be normalized with the yield stress.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StressConstraint" class="doc_header"><code>class</code> <code>StressConstraint</code><a href="dl4to/criteria.py#L946" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StressConstraint</code>(<strong><code>threshold_fct</code></strong>:<code>str</code>=<em><code>'softplus'</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>This criterion solves the PDE for linear elasticity and checks if the absolute maximum von Mises stress is below the yield stress and punishes higher stress values.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>threshold_fct</code></strong></td>
<td><code>str</code></td>
<td><code>softplus</code></td>
<td>The function that determines how von Mises stress values above the yield stress are punished. Can be either "relu" or "softplus", which is a smoothed version of ReLU.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Fail" class="doc_header"><code>class</code> <code>Fail</code><a href="dl4to/criteria.py#L983" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Fail</code>(<strong><code>ε</code></strong>:<code>float</code>=<em><code>0.1</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>Checks for each solution if the structure fails to either underpinned force (i.e., the forces are not connected to the rest of the structure) or too high von Mises stresses.
If the structure fails for any of these reasons, then the criterion returns a value of 1, otherwise it returns 0.
Averaging over the output of this criterion results in the fail percentage criterion [1].</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>ε</code></strong></td>
<td><code>float</code></td>
<td><code>0.1</code></td>
<td>A tolerance that defines how much the absolute maximal von Mises stresses are tolerated to be slightly higher than the yield stresses. By default, this value is 0.1, i.e., a structure does still count as valid if the von Mises stresses are below 110% of the yield stress.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="StressEfficiency" class="doc_header"><code>class</code> <code>StressEfficiency</code><a href="dl4to/criteria.py#L1017" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>StressEfficiency</code>(<strong><code>compute_only_for_not_underpinned</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>Returns the stress efficiency, which is calculated by dividing the mean von Mises stress through the maximum absolute von Mises stress.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>compute_only_for_not_underpinned</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether not connected voxels should be included in the calculation. If True, then the stress efficiency is only computed for voxels that are connected to the structure.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_markdown rendered_html output_subarea ">
<h2 id="Binariness" class="doc_header"><code>class</code> <code>Binariness</code><a href="dl4to/criteria.py#L1061" class="source_link" style="float:right">[source]</a></h2><blockquote><p><code>Binariness</code>(<strong><code>low</code></strong>:<code>bool</code>=<em><code>0.1</code></em>, <strong><code>high</code></strong>:<code>bool</code>=<em><code>0.9</code></em>, <strong><code>compute_only_on_design_space</code></strong>:<code>bool</code>=<em><code>True</code></em>) :: <a href="/dl4tounsupervised_criteria.html#UnsupervisedCriterion"><code>UnsupervisedCriterion</code></a></p>
</blockquote>
<p>This criterion is a measure for how binary a density distribution is. A value of 1 indicates that all density values are below <code>low</code> or above <code>high</code>. A value of 0 indicates that all values are between <code>low</code> and <code>high</code>.</p>
<table>
<thead><tr>
<th></th>
<th>Type</th>
<th>Default</th>
<th>Details</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong><code>low</code></strong></td>
<td><code>bool</code></td>
<td><code>0.1</code></td>
<td>The lower threshold below which densities are considered binary.</td>
</tr>
<tr>
<td><strong><code>high</code></strong></td>
<td><code>bool</code></td>
<td><code>0.9</code></td>
<td>The upper threshold above which densities are considered binary.</td>
</tr>
<tr>
<td><strong><code>compute_only_on_design_space</code></strong></td>
<td><code>bool</code></td>
<td><code>True</code></td>
<td>Whether the criterion should be evaluated on voxels that have a design space information of -1, i.e., the voxels can be freely optimized. This parameter does not effect all criteria.</td>
</tr>
</tbody>
</table>

</div>

</div>

</div>
</div>

</div>
    {% endraw %}

    {% raw %}
    
<div class="cell border-box-sizing code_cell rendered">

</div>
    {% endraw %}

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="References">References<a class="anchor-link" href="#References"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>[1] Dittmer, Sören, et al. "SELTO: Sample-Efficient Learned Topology Optimization." arXiv preprint arXiv:2209.05098 (2022).</p>

</div>
</div>
</div>
</div>
 

